---
import { Image, Picture } from "astro:assets";
import Spacer from "../../components/Spacer.astro";
import MainLayout from "../../layouts/MainLayout.astro";
import SolidButton from "../../components/Buttons/SolidButton.astro";

// Use Astro.glob() to fetch all posts, and then sort them by date.
const posts = (await Astro.glob("./*.{md,mdx}")).sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).valueOf() -
    new Date(a.frontmatter.pubDate).valueOf(),
);
---

<!-- Categories: Development, Tech-Adjacent, Miscellaneous -->
<MainLayout title="Matthew Berger | Blog">
  <div class="flex items-start gap-8">
    <section class="flex basis-2/3 flex-col">
      {
        posts.map((post, idx) => {
          if (idx === 0) {
            return (
              <div class="rounded-2xl bg-blue-600 p-4">
                <img
                  src={post.frontmatter.image}
                  alt="Project card image"
                  class="aspect-video rounded-xl border-blue-600 object-cover"
                />
                <div class="p-4">
                  <h3 class="font-phudu">{post.frontmatter.type}</h3>
                  <h2 class="font-phudu text-2xl font-medium">
                    {post.frontmatter.title}
                  </h2>
                  <p class="max-w-[55ch] leading-relaxed font-width-[87]">
                    {post.frontmatter.summary}
                  </p>
                  <SolidButton
                    text="Read More"
                    background="yellow"
                    foreground="blue"
                    path={post.url}
                  />
                </div>
              </div>
            );
          } else {
            return (
              <div class="flex gap-8 border-b border-livid-500 px-4 py-8 transition-transform duration-300">
                <div class="basis-3/4">
                  <h3 class="font-phudu">{post.frontmatter.type}</h3>
                  <h2 class="font-phudu text-2xl font-medium text-yellow-600">
                    {post.frontmatter.title}
                  </h2>
                  <p class="max-w-[55ch] leading-relaxed font-width-[87]">
                    {post.frontmatter.summary}
                  </p>
                  <SolidButton
                    text="Read More"
                    background="yellow"
                    foreground="livid"
                    path={post.url}
                  />
                </div>
                <div class="basis-1/4">
                  {post.frontmatter.image && (
                    <Image
                      src={post.frontmatter.image}
                      class="aspect-square rounded-lg object-cover"
                      width={"200"}
                      height={"200"}
                      alt={"Blog Header Image"}
                      format={"webp"}
                    />
                  )}
                </div>
              </div>
            );
          }
        })
      }
    </section>
    <aside class="sticky top-8 basis-1/3 rounded-xl bg-orange-600 p-8">
      <h1
        class="rotate-180 font-phudu text-6xl font-bold text-yellow-600 [writing-mode:vertical-lr]"
      >
        Thoughts On
      </h1>
      <ul
        class="space-y-2 text-right font-phudu text-lg text-yellow-600 md:flex-row md:space-x-12"
      >
        <li class="text-xl font-semibold underline underline-offset-[5px]">
          <a href="./">All Posts</a>
        </li>
        <li class="hover:underline hover:underline-offset-[5px]">
          <a href="/blog/category/development">Development</a>
        </li>
        <li class="hover:underline hover:underline-offset-[5px]">
          <a href="/blog/category/tech-adjacent">Tech Adjacent</a>
        </li>
        <li class="hover:underline hover:underline-offset-[5px]">
          <a href="/blog/category/miscellaneous">Miscellaneous</a>
        </li>
      </ul>
    </aside>
  </div>
  <Spacer />
</MainLayout>
